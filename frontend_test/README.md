# 前端测试页面使用说明

## 📋 测试页面列表

### 1. observation-test.html - 行为观察测试
测试 Memory 驱动的行为记录系统

**功能：**
- ✅ 文字观察记录（LLM 智能解析）
- ✅ 快速按钮记录（6种预设按钮）
- ✅ 查看最近观察记录
- ✅ 统计信息展示

**测试的 API：**
- `POST /api/observation/text` - 文字观察
- `POST /api/observation/quick` - 快速按钮
- `GET /api/observation/recent/{child_id}` - 最近记录
- `GET /api/observation/stats/{child_id}` - 统计信息

---

## 🚀 使用步骤

### 1. 启动后端服务

```bash
# 确保 Neo4j 已启动
# 确保 .env 配置正确

# 启动 FastAPI 服务器
python -m uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

### 2. 打开测试页面

直接在浏览器中打开：
```
frontend_test/observation-test.html
```

### 3. 配置测试参数

在页面顶部的"配置"区域：
- **API 地址**：默认 `http://localhost:8000`
- **孩子 ID**：默认 `test_child_001`（可以修改）

### 4. 开始测试

#### 测试文字观察
1. 在"文字观察记录"区域输入观察内容
2. 例如：`今天小明主动把积木递给我，还看着我的眼睛笑了`
3. 可选填写地点
4. 点击"提交观察"
5. 查看 LLM 解析结果（事件类型、重要性等）

#### 测试快速按钮
1. 在"快速记录按钮"区域点击任意按钮
2. 例如：点击"👁️ 主动眼神接触"
3. 系统自动记录预设行为

#### 查看记录
1. 点击"刷新记录"查看最近的观察
2. 每条记录显示：
   - 事件类型（social/behavior/emotion等）
   - 重要性（breakthrough/improvement/normal）
   - 描述内容
   - 时间戳

#### 查看统计
1. 点击"查看统计"
2. 显示：
   - 总记录数
   - 突破性进步次数
   - 事件类型分布
   - 重要性分布

---

## 🧪 测试场景

### 场景 1：日常观察记录
```
输入：今天小红在玩积木时，主动拉着妈妈的手，指着积木说"妈妈看"
期望：LLM 解析为 social 类型，significance 为 improvement
```

### 场景 2：突破性进步
```
输入：小明第一次主动叫了"妈妈"，之前从来没有主动叫过
期望：LLM 解析为 breakthrough，并识别为首次行为
```

### 场景 3：情绪波动
```
输入：孩子突然大哭，拒绝继续玩游戏
期望：LLM 解析为 emotion 类型，significance 为 concern
```

### 场景 4：快速按钮
```
点击：主动眼神接触
期望：快速创建行为记录，无需 LLM 解析
```

---

## 🔍 验证要点

### 1. LLM 智能解析
- ✅ 能否正确识别事件类型（social/behavior/emotion/communication）
- ✅ 能否正确判断重要性（breakthrough/improvement/normal/concern）
- ✅ 能否提取关键信息（对象、兴趣、功能维度）

### 2. 数据持久化
- ✅ 记录是否保存到 Neo4j
- ✅ 关系图谱是否正确建立
- ✅ 能否正确查询历史记录

### 3. 统计功能
- ✅ 统计数据是否准确
- ✅ 事件类型分布是否正确
- ✅ 突破性进步是否正确识别

---

## 🐛 常见问题

### 1. 连接失败
**问题**：页面显示"网络错误"
**解决**：
- 检查后端服务是否启动（`http://localhost:8000/health`）
- 检查 API 地址是否正确
- 检查浏览器控制台的错误信息

### 2. LLM 解析失败
**问题**：提交后返回错误
**解决**：
- 检查 `.env` 中的 `LLM_API_KEY` 是否配置
- 检查 LLM 服务是否可用
- 查看后端日志

### 3. 数据库连接失败
**问题**：后端报错 Neo4j 连接失败
**解决**：
- 检查 Neo4j 是否启动
- 检查 `.env` 中的 Neo4j 配置
- 确认端口 7688 是否正确

### 4. 孩子档案不存在
**问题**：提示"孩子档案不存在"
**解决**：
- 先运行测试脚本创建测试孩子：
  ```bash
  python tests/test_observation_service.py
  ```
- 或者修改页面中的 `child_id` 为已存在的孩子

---

## 📊 测试数据示例

### 文字观察示例
```
1. 今天小明主动把积木递给我，还看着我的眼睛笑了
2. 孩子听到音乐就开心地跳舞，手舞足蹈
3. 小红拉着妈妈的手去拿玩具，还回头看了妈妈一眼
4. 孩子突然大哭，拒绝继续玩游戏
5. 第一次主动叫了"妈妈"，之前从来没有主动叫过
```

### 快速按钮说明
- **主动眼神接触**：孩子主动进行眼神接触
- **主动分享玩具**：孩子主动分享玩具
- **情绪波动**：孩子出现情绪波动
- **拒绝互动**：孩子拒绝互动
- **首次新行为**：孩子首次出现新行为
- **突破性进步**：孩子出现突破性进步

---

## 🎯 下一步

完成行为观察测试后，可以继续测试：
1. 游戏推荐功能（待创建测试页面）
2. 档案管理功能（待创建测试页面）
3. 评估功能（待创建测试页面）

---

## 📝 反馈

测试过程中如有问题，请记录：
1. 操作步骤
2. 期望结果
3. 实际结果
4. 错误信息（浏览器控制台 + 后端日志）
