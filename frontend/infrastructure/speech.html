<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>语音处理服务 - 测试页面</title>
    <link rel="stylesheet" href="../common/styles.css">
</head>
<body>
    <div class="header">
        <h1>语音处理服务</h1>
        <p>语音转文字与文字转语音</p>
        <a href="../index.html" class="back-link">← 返回首页</a>
    </div>

    <div class="container">
        <!-- 接口1: 语音转文字 -->
        <div class="api-section">
            <h2>1. 语音转文字 (STT)</h2>
            <p class="description">将语音文件转换为文本</p>

            <div class="form-group">
                <label>音频文件路径</label>
                <input type="text" id="stt-audio-path" placeholder="/path/to/audio.wav">
            </div>

            <div class="button-group">
                <button onclick="speechToText()">执行</button>
                <button onclick="fillSTTExample()">填充示例</button>
                <button onclick="clearSTT()">清空</button>
            </div>

            <div id="stt-result" class="result-container"></div>
        </div>

        <!-- 接口2: 文字转语音 -->
        <div class="api-section">
            <h2>2. 文字转语音 (TTS)</h2>
            <p class="description">将文本转换为语音文件</p>

            <div class="form-group">
                <label>文本内容</label>
                <textarea id="tts-text" rows="6" placeholder="请输入要转换为语音的文本内容..."></textarea>
            </div>

            <div class="button-group">
                <button onclick="textToSpeech()">执行</button>
                <button onclick="fillTTSExample()">填充示例</button>
                <button onclick="clearTTS()">清空</button>
            </div>

            <div id="tts-result" class="result-container"></div>
        </div>
    </div>

    <script src="../common/api-client.js"></script>
    <script>
        const client = new APIClient();

        // 接口1: 语音转文字
        async function speechToText() {
            const data = {
                audio_path: document.getElementById('stt-audio-path').value
            };
            await client.post('/api/infrastructure/speech/speech-to-text', data, 'stt-result');
        }

        function fillSTTExample() {
            document.getElementById('stt-audio-path').value = '/audio/observation_001.wav';
        }

        function clearSTT() {
            document.getElementById('stt-audio-path').value = '';
            document.getElementById('stt-result').innerHTML = '';
        }

        // 接口2: 文字转语音
        async function textToSpeech() {
            const data = {
                text: document.getElementById('tts-text').value
            };
            await client.post('/api/infrastructure/speech/text-to-speech', data, 'tts-result');
        }

        function fillTTSExample() {
            document.getElementById('tts-text').value = `很棒！宝宝刚才主动注意到了积木，并且尝试去拿。这是一个很好的进步。

接下来，我们可以尝试：
1. 把积木放在宝宝的视线范围内，观察他的反应
2. 用轻柔的声音说"看，积木"，引导他的注意力
3. 如果宝宝伸手去拿，及时给予鼓励

记得保持耐心，跟随宝宝的节奏。`;
        }

        function clearTTS() {
            document.getElementById('tts-text').value = '';
            document.getElementById('tts-result').innerHTML = '';
        }
    </script>
</body>
</html>
