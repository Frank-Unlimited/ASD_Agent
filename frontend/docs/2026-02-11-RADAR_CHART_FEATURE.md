# 兴趣维度雷达图功能 - 时间轴版本

## 功能概述

兴趣维度雷达图是一个动态可视化工具，通过时间轴展示孩子在8个兴趣维度上的关联度和强度数据的演变过程。家长和治疗师可以通过拖动时间轴或自动播放，直观地观察孩子兴趣偏好随时间的变化趋势。

## 核心功能

### 1. 时间轴拖动条

- **动态展示**：拖动滑块查看不同时间点的累计数据
- **实时更新**：雷达图随滑块位置实时更新
- **时间刻度**：显示开始日期和结束日期
- **进度指示**：滑块颜色渐变显示当前进度

### 2. 自动播放功能

- **播放/暂停**：点击按钮自动演示数据变化过程
- **播放速度**：每秒前进一个时间点
- **智能循环**：播放到最后自动停止，可从头重新播放
- **手动控制**：拖动滑块时自动暂停播放

### 3. 三种显示模式

- **关联度模式**：显示行为与各兴趣维度的关联程度累计值（蓝色）
- **强度模式**：显示孩子对各维度的喜好程度累计值（绿色）
- **两者模式**：同时显示关联度和强度（蓝色+绿色）

### 4. 实时数据摘要

每个时间点显示：
- 当前日期
- 截止到该日期的总行为记录数
- 关联度最高的维度
- 最喜欢的维度（强度最高）
- 最抗拒的维度（强度最低）

### 5. 交互式雷达图

- 使用 Recharts 库渲染
- 鼠标悬停显示详细数据
- 平滑动画过渡（300ms）
- 显示每个维度的累计值和记录数量
- 图例说明不同颜色的含义

## 数据来源

雷达图数据来自 localStorage 中存储的所有行为记录（`asd_floortime_behaviors`），包括：
- 游戏中的行为记录（source: 'GAME'）
- 报告导入的行为记录（source: 'REPORT'）
- 聊天中的行为记录（source: 'CHAT'）

## 数据计算方式

### 时间轴生成
1. 按日期分组所有行为记录
2. 对每个日期，计算从开始到该日期的累计数据
3. 生成按日期排序的时间轴数据点数组

### 关联度（Weight）
- 取值范围：0.1 - 1.0
- 计算方式：从开始到当前时间点，所有行为记录中该维度的 weight 值累计加和
- 含义：行为与该兴趣维度的关联程度累计值

### 强度（Intensity）
- 取值范围：-1.0 - 1.0
- 计算方式：从开始到当前时间点，所有行为记录中该维度的 intensity 值累计加和
- 含义：孩子对该维度的喜好程度累计值
  - 正值：喜欢
  - 负值：讨厌
  - 0：中性

## 8个兴趣维度

1. **视觉（Visual）**：对视觉刺激的兴趣
2. **听觉（Auditory）**：对声音和音乐的兴趣
3. **触觉（Tactile）**：对触摸和质感的兴趣
4. **运动（Motor）**：对身体运动的兴趣
5. **建构（Construction）**：对搭建和组装的兴趣
6. **秩序（Order）**：对规则和秩序的兴趣
7. **认知（Cognitive）**：对思考和学习的兴趣
8. **社交（Social）**：对人际互动的兴趣

## 使用场景

### 1. 观察兴趣发展趋势
- 拖动时间轴查看兴趣维度的演变
- 识别哪些维度在增长，哪些在减弱
- 发现兴趣偏好的转折点

### 2. 评估干预效果
- 对比干预前后的雷达图变化
- 验证干预计划是否有效
- 调整干预策略

### 3. 制定个性化计划
- 基于当前雷达图数据制定干预方案
- 平衡各维度的发展
- 强化优势，改善弱项

### 4. 家长沟通
- 用动态演示向家长展示孩子的进步
- 帮助家长理解孩子的兴趣变化
- 增强家长的信心和参与度

## 操作指南

### 基本操作
1. 进入"兴趣雷达图"页面
2. 选择显示类型（关联度/强度/两者）
3. 拖动时间轴滑块查看不同时间点的数据
4. 观察雷达图的变化

### 自动播放
1. 点击"播放"按钮开始自动演示
2. 系统每秒前进一个时间点
3. 点击"暂停"按钮停止播放
4. 点击"重置"按钮回到开始

### 查看详情
1. 鼠标悬停在雷达图上查看具体数值
2. 查看当前日期和数据摘要
3. 了解截止到该日期的总行为数

## 技术实现

### 文件结构
```
frontend/
├── src/
│   ├── components/
│   │   └── RadarChartPage.tsx          # 雷达图页面组件（时间轴版本）
│   ├── services/
│   │   ├── radarChartService.ts        # 雷达图数据服务（时间轴版本）
│   │   └── behaviorStorage.ts          # 行为数据存储服务
│   └── types/
│       └── index.ts                     # 类型定义
└── index.html                           # 包含滑块自定义样式
```

### 核心类型
```typescript
// 时间轴数据点
export interface TimelineDataPoint {
  date: string; // YYYY-MM-DD
  data: RadarDataPoint[]; // 8个维度的累计数据
  totalBehaviors: number; // 截止到该日期的总行为数
  summary: string; // 数据摘要
}

// 雷达图数据点
export interface RadarDataPoint {
  dimension: InterestDimensionType;
  weight: number; // 累计关联度
  intensity: number; // 累计强度
  count: number; // 记录数量
}
```

### 核心服务函数
```typescript
// 获取时间轴数据（按日期排序的累计数据点数组）
getTimelineData(): TimelineDataPoint[]

// 获取维度标签
getDimensionLabel(dimension: InterestDimensionType): string
```

### 关键特性
1. **累计计算**：每个时间点显示从开始到该日期的累计数据
2. **按日期分组**：自动按日期分组行为记录
3. **实时更新**：拖动滑块时雷达图实时更新
4. **平滑动画**：300ms 的动画过渡效果
5. **自定义滑块**：美化的滑块样式，支持悬停效果

## 优势特点

### 相比静态雷达图
1. **动态展示**：可以看到数据随时间的变化过程
2. **趋势分析**：更容易识别兴趣发展趋势
3. **交互性强**：用户可以自由探索不同时间点
4. **直观易懂**：动画演示比静态图表更容易理解

### 用户体验
1. **操作简单**：拖动滑块即可查看
2. **反馈及时**：实时更新，无需等待
3. **视觉美观**：平滑动画和渐变效果
4. **信息丰富**：每个时间点都有详细摘要

## 未来优化方向

1. **速度控制**：允许用户调整播放速度
2. **关键帧标记**：在时间轴上标记重要事件
3. **对比模式**：同时显示两个时间点的雷达图对比
4. **数据导出**：导出时间轴动画为视频或GIF
5. **趋势预测**：基于历史数据预测未来趋势
6. **多维度分析**：添加更多维度的时间轴分析

## 注意事项

1. 雷达图数据基于 localStorage，清空浏览器缓存会丢失数据
2. 如果没有行为记录，页面会显示"暂无数据"提示
3. 时间轴按日期分组，同一天的多条记录会合并显示
4. 累计值会随时间递增，不会减少
5. 强度值可能为负数，表示孩子对该维度的抗拒

## 更新日志

### 2026-02-11 v2.0 - 时间轴版本
- ✅ 重新设计为时间轴交互模式
- ✅ 添加时间轴拖动条
- ✅ 实现自动播放功能
- ✅ 添加播放/暂停/重置控制
- ✅ 实现累计数据计算
- ✅ 添加平滑动画过渡
- ✅ 自定义滑块样式
- ✅ 优化数据摘要显示
- ✅ 移除静态时间范围选择

### 2026-02-11 v1.0 - 初始版本
- ✅ 创建雷达图页面组件
- ✅ 实现雷达图数据服务
- ✅ 添加三种显示模式（关联度/强度/两者）
- ✅ 实现预设和自定义时间范围选择
- ✅ 集成到主应用和侧边栏菜单
- ✅ 添加数据摘要和交互式 Tooltip
