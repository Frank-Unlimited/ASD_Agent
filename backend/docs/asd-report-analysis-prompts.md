# ASD 报告分析 Prompts 说明文档

本文档说明了系统中用于分析孤独症评估报告的两个专业 Prompt 的设计思路和使用场景。

## 1. ASD_REPORT_ANALYSIS_PROMPT

### 使用场景
用于**引导页面**（PageWelcome）的报告上传功能，帮助家长快速了解孩子的整体情况。

### 设计目标
- **家长友好**：生成易于理解、温和的孩子画像
- **全面概括**：涵盖核心症状、感觉特点、认知能力、情绪调节、优势潜能和支持需求
- **简洁明了**：字数控制在 400-600 字，便于快速阅读
- **积极导向**：突出孩子的优势和潜能，而不仅仅是困难

### Prompt 结构

#### 任务要求
1. **文字提取**：识别报告中的关键信息
   - 诊断结论
   - 评估量表（CARS、ABC、ADOS、ADI-R 等）
   - 行为观察记录
   - 发展里程碑
   - 医生建议

2. **专业分析**：生成孩子的整体画像

#### 画像维度
1. **核心症状表现**
   - 社交互动障碍
   - 沟通交流障碍
   - 重复刻板行为

2. **感觉处理特点**
   - 感觉敏感性
   - 感觉寻求/回避行为
   - 感觉调节能力

3. **认知与学习能力**
   - 认知发展水平
   - 学习特点和优势
   - 注意力和执行功能

4. **情绪与行为调节**
   - 情绪表达和识别
   - 自我调节能力
   - 问题行为及触发因素

5. **优势与潜能**
   - 特殊才能或兴趣
   - 优势发展领域
   - 学习动机

6. **支持需求**
   - 需要支持的领域
   - 干预重点
   - 家庭关注方向

#### 输出要求
- 温和、专业且易于理解的语言
- 避免过度医学化术语
- 突出优势和潜能
- 400-600 字
- 清晰的段落结构

---

## 2. ASD_REPORT_STRUCTURED_ANALYSIS_PROMPT

### 使用场景
用于**档案页面**（PageProfile）的报告导入功能，提取结构化数据用于系统存储和后续分析。

### 设计目标
- **结构化提取**：按照固定格式提取报告中的所有关键数据
- **数据完整性**：尽可能提取所有可用信息
- **便于存储**：输出格式适合存入数据库
- **支持分析**：为后续的数据分析和趋势追踪提供基础

### Prompt 结构

#### 第一步：文字识别与提取

1. **基本信息**
   - 儿童姓名、性别、年龄/出生日期
   - 评估日期、评估机构
   - 主诊医生/评估师

2. **诊断信息**
   - 明确的诊断结论
   - 诊断依据（DSM-5、ICD-11）
   - 严重程度分级

3. **评估量表数据**
   - 量表名称
   - 各项得分和总分
   - 百分位数或标准分
   - 临界值说明

4. **行为观察记录**
   - 社交互动表现
   - 语言沟通能力
   - 重复刻板行为
   - 感觉处理特点
   - 情绪调节能力
   - 认知表现

5. **发展评估**
   - 大运动发展
   - 精细动作发展
   - 语言发展
   - 认知发展
   - 社会适应能力
   - 自理能力

6. **医生建议**
   - 干预建议
   - 复查时间
   - 注意事项

#### 第二步：综合分析与画像生成

- 核心特征
- 发展优势
- 发展挑战
- 感觉特点
- 干预建议

#### 输出格式

```
【报告基本信息】
（提取的基本信息）

【诊断结论】
（明确的诊断）

【评估数据】
（量表得分等数据）

【发展画像】
（综合分析，400-500字）

【关键建议】
（3-5条核心建议）
```

---

## 两个 Prompt 的对比

| 特性 | ASD_REPORT_ANALYSIS_PROMPT | ASD_REPORT_STRUCTURED_ANALYSIS_PROMPT |
|------|---------------------------|--------------------------------------|
| **使用场景** | 引导页面 | 档案页面 |
| **主要目标** | 生成家长友好的画像 | 提取结构化数据 |
| **输出格式** | 自然语言段落 | 结构化分段 |
| **字数要求** | 400-600 字 | 400-500 字（画像部分） |
| **数据完整性** | 关注核心信息 | 尽可能完整提取 |
| **语言风格** | 温和、积极 | 客观、专业 |
| **后续用途** | 直接展示给家长 | 存储到数据库 |

---

## 设计原则

### 1. 专业性
- 基于 ASD 诊断标准（DSM-5、ICD-11）
- 涵盖常用评估量表（CARS、ABC、ADOS、ADI-R 等）
- 遵循儿童发展评估的专业框架

### 2. 同理心
- 使用温和、支持性的语言
- 突出孩子的优势和潜能
- 避免标签化和过度医学化

### 3. 实用性
- 提供可操作的建议
- 关注家庭可以实施的策略
- 明确干预重点和方向

### 4. 准确性
- 基于报告内容进行分析
- 不臆测或添加报告中没有的信息
- 对模糊或缺失的信息进行标注

### 5. 可读性
- 清晰的结构和段落
- 适当的字数控制
- 易于理解的表达方式

---

## 使用示例

### 示例 1：引导页面报告分析

**输入**：家长上传的 CARS 评估报告图片

**Prompt**：`ASD_REPORT_ANALYSIS_PROMPT`

**输出示例**：
```
根据评估报告，孩子在社交互动方面表现出一定的挑战，眼神接触较少，
更倾向于独自玩耍。在语言沟通上，能够理解简单指令，但主动表达较少，
多使用单词或短语。孩子对旋转的物体和规律性的活动表现出浓厚兴趣，
这可以成为建立互动的良好切入点。

在感觉处理方面，孩子对声音较为敏感，突然的响声可能引起不适。
同时，孩子在视觉记忆和拼图方面展现出较强的能力，这是很好的优势领域。

建议重点关注：1) 通过孩子感兴趣的活动建立眼神接触和共同注意；
2) 在日常生活中创造更多沟通机会；3) 利用视觉优势进行学习。
```

### 示例 2：档案页面报告分析

**输入**：家长上传的综合评估报告图片

**Prompt**：`ASD_REPORT_STRUCTURED_ANALYSIS_PROMPT`

**输出示例**：
```
【报告基本信息】
儿童姓名：张小明
性别：男
年龄：4岁3个月
评估日期：2024年1月15日
评估机构：XX儿童发展中心
评估师：李医生

【诊断结论】
孤独症谱系障碍（ASD），需要支持级别2

【评估数据】
- CARS量表：总分 35 分（轻中度孤独症）
- ABC量表：感觉 8分，交往 12分，躯体运动 6分，语言 10分，生活自理 7分
- 韦氏智力量表：VIQ 85，PIQ 95，FIQ 88

【发展画像】
（400-500字的综合分析）

【关键建议】
1. 优先开展地板时光干预，建立情感连接
2. 利用视觉优势进行结构化教学
3. 创造感觉友好的环境，减少听觉刺激
4. 每日进行30分钟的互动游戏
5. 3个月后复查评估进展
```

---

## 技术实现

### 调用方式

```typescript
// 引导页面
const result = await multimodalService.parseImage(
  file, 
  ASD_REPORT_ANALYSIS_PROMPT
);

// 档案页面
const result = await multimodalService.parseImage(
  file, 
  ASD_REPORT_STRUCTURED_ANALYSIS_PROMPT
);
```

### 多模态模型
- 使用阿里云 DashScope 的 qwen-vl-max 模型
- 支持图片识别和文字提取
- 具备专业的医疗文档理解能力

---

## 未来优化方向

1. **Few-shot Learning**
   - 提供示例报告和期望输出
   - 提高输出格式的一致性

2. **多语言支持**
   - 支持英文报告分析
   - 支持繁体中文报告

3. **量表专项优化**
   - 针对不同量表定制提取规则
   - 自动识别量表类型

4. **结构化输出**
   - 使用 JSON Schema 约束输出格式
   - 便于直接存入数据库

5. **置信度评估**
   - 对提取的信息标注置信度
   - 对模糊内容进行标记

6. **多报告整合**
   - 支持上传多份报告
   - 自动整合和对比分析

---

## 参考资料

- DSM-5 孤独症谱系障碍诊断标准
- CARS（儿童孤独症评定量表）
- ABC（孤独症行为量表）
- ADOS-2（孤独症诊断观察量表）
- DIR/Floortime 模型
- 儿童发展评估标准

---

**文档版本**：v1.0  
**最后更新**：2025-02-09  
**维护者**：ASD 地板时光助手开发团队
